@using BookStore.BusnessLogic.ViewsModels.Order ;
@using BookStore.BusnessLogic.Helper ;
@model OrderView


<div class="container-fluid">
    <form method="post">
    <div class="row d-flex justify-content-between">
        <div class="col-6">
           @*  <form asp-action="Details" asp-route-Id="@Model.Header.Id"> *@
                <input asp-for="@Model.Header.Id" name="Header_id" hidden class="form-control">
                <div class="form-group">
                    <label asp-for="@Model.Header.Name"></label>
                    @if (User.IsInRole("Admin"))
                    {
                        <input asp-for="@Model.Header.Name" name="Header_Name" class="form-control">
                        <span asp-validation-for="@Model.Header.Name"></span>
                    }
                    else
                    {
                        <input asp-for="@Model.Header.Name" readonly class="form-control">
                        
                    }
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Header.PhoneNumber"></label>
                    @if (User.IsInRole("Admin"))
                    {
                        <input asp-for="@Model.Header.PhoneNumber" name="Header_PhoneNumber" class="form-control">
                        <span asp-validation-for="@Model.Header.PhoneNumber"></span>
                    }
                    else
                    {
                        <input asp-for="@Model.Header.PhoneNumber" readonly class="form-control">
                        
                    }
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Header.StreetAddress"></label>
                    @if (User.IsInRole("Admin"))
                    {
                        <input asp-for="@Model.Header.StreetAddress" name="Header_StreetAddress" class="form-control">
                        <span asp-validation-for="@Model.Header.StreetAddress"></span>
                    }
                    else
                    {
                        <input asp-for="@Model.Header.StreetAddress" readonly class="form-control">                       
                    }
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Header.City"></label>
                    @if (User.IsInRole("Admin"))
                    {
                        <input asp-for="@Model.Header.City" name="Header_City" class="form-control">
                        <span asp-validation-for="@Model.Header.City"></span>
                    }
                    else
                    {
                        <input asp-for="@Model.Header.City" readonly class="form-control">
                       
                    }
                    </div>
                <div class="form-group">
                    <label asp-for="@Model.Header.State"></label>
                    @if (User.IsInRole("Admin"))
                    {
                            <input asp-for="@Model.Header.State" name="Header_State" class="form-control">
                        <span asp-validation-for="@Model.Header.State"></span>
                    }
                    else
                    {
                        <input asp-for="@Model.Header.State" readonly class="form-control">
                        
                    }
                </div>
                <div class="form-group">
                        <label asp-for="@Model.Header.ApplicationUser.Email"></label>
                        <input asp-for="@Model.Header.ApplicationUser.Email" readonly class="form-control">

                </div>
                <div class="form-group">
                        <label asp-for="@Model.Header.OrderDate"></label>
                        <input asp-for="@Model.Header.OrderDate" readonly class="form-control">

                </div>
                <div class="form-group">
                    <label asp-for="@Model.Header.Carrier"></label>
                    @if (User.IsInRole("Admin"))
                    {
                        <input asp-for="@Model.Header.Carrier" id="Header_Carrier" name="Header_Carrier" class="form-control">
                    }
                    else
                    {
                        <input asp-for="@Model.Header.Carrier" readonly class="form-control">
                        <span asp-validation-for="@Model.Header.Carrier"></span>
                    }
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Header.TrackingNumber"></label>
                    @if (User.IsInRole("Admin"))
                    {
                        <input asp-for="@Model.Header.TrackingNumber" id="Header_TrackingNumber" name="Header_TrackingNumber" class="form-control">
                    }
                    else
                    {
                        <input asp-for="@Model.Header.TrackingNumber" readonly class="form-control">
                        <span asp-validation-for="@Model.Header.TrackingNumber"></span>
                    }
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Header.ShippingDate"></label>
                    @if (User.IsInRole("Admin"))
                    {
                        <input asp-for="@Model.Header.ShippingDate" class="form-control">
                    }
                    else
                    {
                        <input asp-for="@Model.Header.ShippingDate" readonly class="form-control">
                        <span asp-validation-for="@Model.Header.ShippingDate"></span>
                    }
                </div>
                <div class="form-group">
                        <label asp-for="@Model.Header.SessionId"></label>
                        <input asp-for="@Model.Header.SessionId" readonly class="form-control">
                </div>
                <div class="form-group">
                        <label asp-for="@Model.Header.PaymentIntentId"></label>
                        <input asp-for="@Model.Header.PaymentIntentId" readonly class="form-control">
                </div>
                <div class="form-group">
                        <label asp-for="@Model.Header.PaymentDate"></label>
                        <input asp-for="@Model.Header.PaymentDate" readonly class="form-control">
                </div>
                <div class="form-group">
                    <div class="row my-1">
                        <div class="col-3">
                            <label asp-for="@Model.Header.PaymentStatus"></label>
                        </div>

                            <div class="col-9">
                                <input asp-for="@Model.Header.PaymentStatus" readonly class="form-control">

                            </div>

                    </div>
                </div>           
                @*  <button type="submit" class="btn btn-primary col-12">Update</button>  *@
                <input type="submit" asp-action="Details" class="btn btn-primary col-12" />
                @*  </form> *@
        </div>
     
        <div class="col-6">
            <article class="card">
                <header class="card-header"> My Orders / Tracking </header>
                <div class="card-body">
                    <h6>@($"Order Id {Model.Header.Id}")</h6>
                    <article class="card">
                        <div class="card-body row">
                            <div class="col"> <strong>Estimated Delivery time:</strong> <br>29 nov 2019 </div>
                            <div class="col"> <strong>Shipping BY:</strong> <br> BLUEDART, | <i class="fa fa-phone"></i> +1598675986 </div>
                            <div class="col"> <strong>Status:</strong> <br>@Model.Header.OrderStatus </div>                          
                        </div>
                    </article>                   
                    <hr>
                    <ul class="row">
                        @foreach(var item in Model.Detail)
                        {
                            <li class="col-md-4">
                            <figure class="itemside mb-3">
                                    <div class="aside"><img src=@($"F://BookStore//BookStore.BusnessLogic//Helper//assets//images//products//{item.Product.ImageUrl}") class="img-sm border"></div>
                                <figcaption class="info align-self-center">
                                    <p class="title">@item.Product.Name <br> Quantity:@item.Count</p> <span class="text-muted">@item.Price.ToString("c")</span>
                                </figcaption>
                            </figure>
                        </li>
                            
                        }
                        <li class="list-group-item bg-info">
                            <div class="row container">
                                <div class="col-6">
                                    <h5 class="text-white">TOTAL </h5>
                                </div>
                                <div class="col-6 text-end">
                                    <h5 class="text-white">@Model.Header.OrderTotal.ToString("c")</h5>
                                </div>
                            </div>
                        </li>
                        
                    </ul>
                    <hr>
                    <a href="#" class="btn btn-warning" data-abc="true"> <i class="fa fa-chevron-left"></i> Back to orders</a>
                </div>
            </article>

            @if (User.IsInRole(SD.Role_Admin) || User.IsInRole(SD.Role_Employee))
            {
                if (Model.Header.OrderStatus == SD.StatusApproved)
                {
                    <input type="submit" asp-action="StartProcessing" asp-route-id="@Model.Header.Id"  class="btn btn-primary form-control my-1" value="Start Processing" />
                }
                if (Model.Header.OrderStatus == SD.StatusInProcess)
                {
                        <input type="submit" id="ShipOrder"
                               asp-action="ShipOrder" onclick="return validateInput()" class="btn btn-primary form-control my-1" value="Ship Order" />
                }

                @if (Model.Header.OrderStatus != SD.StatusRefunded &&
               Model.Header.OrderStatus != SD.StatusCancelled &&
               Model.Header.OrderStatus != SD.StatusShipped)
                {
                        <input type="submit" asp-action="CancelOrder" asp-route-id="@Model.Header.Id" class="btn btn-danger form-control my-1" value="Cancel Order" />
                }
            }
          
          
        </div>
    </div>
    </form>
</div>

@section Scripts {
    @{
        <partial name="_ValidationScriptsPartial" />
    }
    <script src="~/js/order/orderdetails.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <!-- Include SweetAlert2 JS -->
    <script src="/path/to/sweetalert2.min.js"></script>
}